<?xml version="1.0" encoding="UTF-8"?>

<tns:views xmlns:tns="http://www.example.org/SPAForms"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.example.org/SPAForms http://www.example.org/SPAForms"
 directory="entidades/cliente"
 channels="ANYCHANNEL" >     



<tns:view name="ListadoCliente" title="listado de cliente">
    
    <tns:variables>
    	<tns:variable variableName="listado" typeName="com.erp.entidades.beans.Cliente" esListado="true"/>
    	<tns:variable variableName="seleccionado" typeName="com.erp.entidades.beans.Cliente"/>
    </tns:variables>
	
	<tns:onInit type="onLoad">
	   <tns:event>
	      <tns:controller name="ListadoClientes">
	         <tns:param localVariable="listado" input="false" output="true"/>
	      </tns:controller>
	   </tns:event>
	</tns:onInit>
	
	<tns:form>
		<tns:row>
		   <tns:fields>
		      <tns:field label="cod servicio" name="lblCorrelativo" localVariable="seleccionado" localVariablePath="correlativo" type="text-field"></tns:field>
		   </tns:fields>
		</tns:row>
		
		<tns:row>
		   <tns:table name="tabla" selectedValue="seleccionado" localVariable="listado">
		    <tns:column title="correlativo" path="correlativo"></tns:column>		    
		   	<tns:column title="cod persona" path="persona/correlativo"></tns:column>
			<tns:column title="tipo cliente" path="tipoCliente/description"></tns:column>		
			<tns:column title="clasificacion" path="clasificacionCliente/description"></tns:column>	
			<tns:column title="ultimo serv" path="ultimoServicio"></tns:column>
			
			<tns:column title="consultar">
			     <tns:eventChain type="onClick">
			        <tns:event>
			           <tns:link viewName="DetalleCliente">
			              <tns:param viewParam="state" constantValue="CN"/>
			              <tns:param viewParam="idCliente" inRow="true" localVariablePath="correlativo"/>
			           </tns:link>
			        </tns:event>
			     </tns:eventChain>
			</tns:column>		 			 			
		   </tns:table>
		</tns:row>
	</tns:form>
	
</tns:view>	

<tns:view name="ListadoClienteModal" title="listado de cliente modal" modal="true">
    
    <tns:variables>
    	<tns:variable variableName="listado" typeName="com.erp.entidades.beans.Cliente" esListado="true"/>
    	<tns:variable variableName="seleccionado" typeName="com.erp.entidades.beans.Cliente"/>
    </tns:variables>
    
    <tns:parameters>
       <tns:param name="clienteSeleccionado" localVariable="seleccionado" input="false" output="true"/>
    </tns:parameters>
    
    <tns:menuBarActions>
       <tns:button menuBarButton="boton.aceptar" applyClose="true">
         <tns:eventChain type="onClick">
            <tns:event>
            </tns:event>
         </tns:eventChain>
       </tns:button>
    </tns:menuBarActions>    
	
	<tns:onInit type="onLoad">
	   <tns:event>
	      <tns:controller name="ListadoClientes">
	         <tns:param localVariable="listado" input="false" output="true"/>
	      </tns:controller>
	   </tns:event>
	</tns:onInit>
	
	<tns:form>
		<tns:row>
		   <tns:fields>
		      <tns:field label="cod servicio" name="lblCorrelativo" localVariable="seleccionado" localVariablePath="correlativo" type="text-field"></tns:field>
		   </tns:fields>
		</tns:row>
		
		<tns:row>
		   <tns:table name="tabla" selectedValue="seleccionado" localVariable="listado">
		    <tns:column title="correlativo" path="correlativo"></tns:column>		    
		   	<tns:column title="cod persona" path="persona/correlativo"></tns:column>
			<tns:column title="tipo cliente" path="tipoCliente/description"></tns:column>		
			<tns:column title="clasificacion" path="clasificacionCliente/description"></tns:column>	
			<tns:column title="ultimo serv" path="ultimoServicio"></tns:column>	 			 			
		   </tns:table>
		</tns:row>
	</tns:form>
	
</tns:view>	


<tns:view name="DetalleCliente" title="detalle cliente" stateAsParam="true">
    <tns:states inheritPredefinedState="baseViewState">
    </tns:states>

    <tns:variables>
    	<tns:variable variableName="parametro" typeName="com.erp.entidades.beans.Cliente"/>
    	
    	<tns:variable variableName="cuentaXCobrar" typeName="com.erp.operaciones.cuentas.beans.CuentaXCobrar"/>
    	<tns:variable variableName="listadoCuentasXCobrar"  typeName="com.erp.operaciones.cuentas.beans.CuentaXCobrar" esListado="true"/>
    	
    	<tns:variable variableName="movimientoSeleccionado" typeName="com.erp.operaciones.cuentas.movimiento.beans.MovimientoCuentaXCobrar"/> 
    	<tns:variable variableName="listadoMovsCtaXCobrar" typeName="com.erp.operaciones.cuentas.movimiento.beans.MovimientoCuentaXCobrar" esListado="true"/>    	    	
    	
    	<tns:variable variableName="facturaSeleccionada" typeName="com.erp.operaciones.facturacion.beans.Factura"/>
    	<tns:variable variableName="listadoFacturas" typeName="com.erp.operaciones.facturacion.beans.Factura" esListado="true"/>   	
    </tns:variables>

	<tns:parameters>
		<tns:param name="idCliente" localVariable="parametro" localVariablePath="correlativo"/>
	</tns:parameters>	

    <tns:menuBarActions>
	   <tns:button menuBarButton="boton.agregar">
	      <tns:eventChain type="onClick"  askConfirmation="true" showSuccessMessage="true">
	         <tns:event>
                <tns:controller name="Cliente" method="create">
                   <tns:param localVariable="parametro" output="true"/>
                </tns:controller>
	         </tns:event>
	      </tns:eventChain>
	   </tns:button>
	   
	   <tns:button menuBarButton="boton.actualizar">
	      <tns:eventChain type="onClick"  askConfirmation="true" showSuccessMessage="true">
	         <tns:event>
                <tns:controller name="Cliente" method="update">
                   <tns:param localVariable="parametro" output="true"/>
                </tns:controller>
	         </tns:event>
	      </tns:eventChain>
	   </tns:button>
	   
	   <tns:button menuBarButton="boton.eliminar">
	      <tns:eventChain type="onClick"  askConfirmation="true" showSuccessMessage="true">
	         <tns:event>
                <tns:controller name="Cliente" method="remove">
                   <tns:param paramPath="correlativo" localVariable="parametro" localVariablePath="correlativo"/>
                   <tns:param paramPath="rowVersion" localVariable="parametro" localVariablePath="rowVersion"/>
                </tns:controller>                 
	         </tns:event>
	      </tns:eventChain>
	   </tns:button>
    </tns:menuBarActions>
	
	<tns:onInit type="onLoad">
	   
	   <tns:event fireOnStates="CN|UP|DE">
	      <tns:controller name="Cliente" method="detail">
	         <tns:param paramPath="correlativo" localVariable="parametro" localVariablePath="correlativo"/>
	         <tns:param localVariable="parametro" input="false" output="true"/>	         
	      </tns:controller>
	   </tns:event>
	   	   
	   <tns:event postExecUserMethodRef="DetalleCliente_setearCuentaXCobrar">
	      <tns:controller name="ListadoCuentaXCobrar">	         
	         <tns:param paramPath="correlativoCliente" localVariable="parametro" localVariablePath="correlativo"/>
	         <tns:param localVariable="listadoCuentasXCobrar" input="false" output="true"/>
	      </tns:controller>
	   </tns:event>
	   
	   <!-- tns:event>
	      <tns:controller name="ListadoMovimientoCuentaXCobrar">
	         <tns:param paramPath="cuenta" localVariable="cuentaXCobrar"/>
	         <tns:param localVariable="listadoMovsCtaXCobrar" input="false" output="true"/>
	      </tns:controller>
	   </tns:event-->
	   
	   <tns:event>
	      <tns:controller name="ListadoFacturas">
	         <tns:param paramPath="correlativoCliente" localVariable="parametro" localVariablePath="correlativo"/>
	         <tns:param localVariable="listadoFacturas" input="false" output="true" />	         
	      </tns:controller>
	   </tns:event>
	   	   
	   
	</tns:onInit>
	
	<tns:tabs>
	   <tns:tab>
		<tns:form title="detalle de cliente">
			<tns:row>
			   <tns:fields>			     			      			      
			      <tns:field label="cod persona" name="lblCodPersona" localVariable="parametro" localVariablePath="persona/correlativo" type="label-field"></tns:field>
			      <tns:field label="primer nombre" name="lblNom1persona" localVariable="parametro" localVariablePath="persona/nombre1" type="label-field"></tns:field>
			      <tns:field label="segundo nombre" name="lblNom2Persona" localVariable="parametro" localVariablePath="persona/nombre2" type="label-field"></tns:field>
			      <tns:field label="primer apellido" name="lblape1persona" localVariable="parametro" localVariablePath="persona/apellido1" type="label-field"></tns:field>
			      <tns:field label="segundo apellido" name="lblape2persona" localVariable="parametro" localVariablePath="persona/apellido2" type="label-field"></tns:field>
			   </tns:fields>
			</tns:row>
			<tns:row>
			   <tns:fields>			             
	             <tns:field label="clasificaicon cliente" name="cboClasificacionCliente" localVariable="parametro" localVariablePath="clasificacionCliente" type="combo-catalog"></tns:field>	
	             <tns:field label="ultimo servicio" name="dtUltimoServicio" localVariable="parametro" localVariablePath="ultimoServicio" type="datepicker"></tns:field>	
	             <tns:field label="aplica factura" name="chkAplicaFactura" localVariable="parametro" localVariablePath="aplicaFactura" type="check-field"></tns:field>
	             <tns:field label="aviso por inasistencia" name="chkAvisoPorInasistencia" localVariable="parametro" localVariablePath="avisoPorInasistencia" type="check-field"></tns:field>
			   </tns:fields>
			</tns:row>
			<tns:row>
			   <tns:fields>					           
	             <tns:field label="ultima asistencia" name="dtUltimaAsistencia" localVariable="parametro" localVariablePath="ultimaAsistencia" type="datepicker"></tns:field>
	             <tns:field label="estado" name="cboEstado" localVariable="parametro" localVariablePath="estado" type="enum-combo"></tns:field>
	             <tns:field label="nit" name="txtNit" localVariable="parametro" localVariablePath="nitDefault" type="text-field"></tns:field>
	             <tns:field label="nombre referente" name="txtNombreReferente" localVariable="parametro" localVariablePath="nombreReferente" type="text-field"></tns:field>
	             <tns:field label="ultimo servicio" name="dtFechaUltServicio" localVariable="parametro" localVariablePath="fechaUltServicio" type="datepicker"></tns:field>
			   </tns:fields>
			</tns:row>
		    <tns:row>
			   <tns:fields>
	             <tns:field label="lugar ultimo servicio" name="txtLugarUltServicio" localVariable="parametro" localVariablePath="lugarUltServicio" type="text-field"></tns:field>
	             <tns:field label="servicio finalizado" name="chkServicioFinalizado" localVariable="parametro" localVariablePath="servicioFinalizado" type="check-field"></tns:field>
	             <!--  private BitwiseCatalogDetailTO serviciosAplicadosAfuera = null; ....PENDIENTE....-->	            
	             <tns:field label="familiares con problemas" name="chkFamiliaresConProblemas" localVariable="parametro" localVariablePath="familiaresConProblemas" type="check-field"></tns:field>
	             <tns:field label="dentista" name="txtDentistaPersonal" localVariable="parametro" localVariablePath="dentistaPersonal" type="text-field"></tns:field>
			   </tns:fields>
			</tns:row>
		</tns:form>	   
	   </tns:tab>

       <tns:tab>
	      <tns:form title="cuenta por cobrar">
	         <tns:row>
	            <tns:fields>
		            <tns:field label="saldo" name="txtctaSaldo" localVariable="cuentaXCobrar" localVariablePath="saldo" type="label-field"></tns:field>
		            <tns:field label="fecha" name="txtctaFecha" localVariable="cuentaXCobrar" localVariablePath="fechaUltMov" type="label-field"></tns:field>
		            <tns:field label="monto" name="txtMontoUlt" localVariable="cuentaXCobrar" localVariablePath="montoUltMov" type="label-field"></tns:field>
		            <tns:field label="estado" name="txtctaEstado" localVariable="cuentaXCobrar" localVariablePath="estCuentaXCobrar/description" type="label-field"></tns:field>
		            <tns:field label="saldo anterior" name="txtctaSaldoAnterio" localVariable="cuentaXCobrar" localVariablePath="saldoAnterior" type="label-field"></tns:field>	            
	            </tns:fields>	            	            
	         </tns:row>
	         
	         <tns:row>
	            <tns:fields>
	               <tns:field label="ver movimiento" name="cmdVerMovimiento" type="button">
					   <tns:eventChain type="onClick">
					      <tns:event>
					         <tns:link viewName="DetalleMovCuentaXCobrarModal">
					            <tns:param viewParam="idMovCuentaXCobrar" localVariable="movimientoSeleccionado" localVariablePath="correlativo"/>
					         </tns:link>
					      </tns:event>
					   </tns:eventChain>	               
	               </tns:field>
	            </tns:fields>
	         </tns:row>
	         
	         <tns:row>
	            <tns:table name="tablaMovsCuentaXCobrar" selectedValue="movimientoSeleccionado" localVariable="listadoMovsCtaXCobrar">
	                <tns:column title="correlativo" path="correlativo"></tns:column>	                	                
	                <tns:column title="id doc" path="documento/correlativo"></tns:column>	
					<tns:column title="fecha" path="fechaMov"></tns:column>
					<tns:column title="monto" path="montoMov"></tns:column>
					<tns:column title="credito debito" path="creditoDebito"></tns:column>
	            </tns:table>
	         </tns:row>
	      </tns:form>
	   </tns:tab>
	   	   	   
	</tns:tabs>

	
</tns:view>	

<tns:view name="DetalleClienteModal" title="detalle cliente modal" modal="true">
    <tns:variables>
    	<tns:variable variableName="parametro" typeName="com.erp.entidades.beans.Cliente"/>    	
    </tns:variables>	
    
    <tns:parameters>
       <tns:param name="idCliente" localVariable="parametro" localVariablePath="correlativo"/>
    </tns:parameters>
    
    <tns:onInit type="onLoad">
       <tns:event>
          <tns:controller name="Cliente" method="detail">
            <tns:param paramPath="correlativo" localVariable="parametro" localVariablePath="correlativo"/>
            <tns:param localVariable="parametro" input="false" output="true"/> 
          </tns:controller>
       </tns:event>
    </tns:onInit>
    
    <tns:menuBarActions>
       <tns:button menuBarButton="boton.aceptar" applyClose="true">
         <tns:eventChain type="onClick">
            <tns:event>
            </tns:event>
         </tns:eventChain>
       </tns:button>
    </tns:menuBarActions>
    
    <tns:form>
		<tns:row>
		   <tns:fields>			     			      			      
		      <tns:field label="cod persona" name="lblCodPersona" localVariable="parametro" localVariablePath="persona/correlativo" type="label-field"></tns:field>
		      <tns:field label="primer nombre" name="lblNom1persona" localVariable="parametro" localVariablePath="persona/nombre1" type="label-field"></tns:field>
		      <tns:field label="segundo nombre" name="lblNom2Persona" localVariable="parametro" localVariablePath="persona/nombre2" type="label-field"></tns:field>
		      <tns:field label="primer apellido" name="lblape1persona" localVariable="parametro" localVariablePath="persona/apellido1" type="label-field"></tns:field>
		      <tns:field label="segundo apellido" name="lblape2persona" localVariable="parametro" localVariablePath="persona/apellido2" type="label-field"></tns:field>
		   </tns:fields>
		</tns:row>
		<tns:row>
		   <tns:fields>			             
	          <tns:field label="clasificaicon cliente" name="cboClasificacionCliente" localVariable="parametro" localVariablePath="clasificacionCliente" type="combo-catalog"></tns:field>	
	          <tns:field label="ultimo servicio" name="dtUltimoServicio" localVariable="parametro" localVariablePath="ultimoServicio" type="datepicker"></tns:field>	
	          <tns:field label="aplica factura" name="chkAplicaFactura" localVariable="parametro" localVariablePath="aplicaFactura" type="check-field"></tns:field>
	          <tns:field label="aviso por inasistencia" name="chkAvisoPorInasistencia" localVariable="parametro" localVariablePath="avisoPorInasistencia" type="check-field"></tns:field>
		   </tns:fields>
		</tns:row>
		<tns:row>
		   <tns:fields>					           
	          <tns:field label="ultima asistencia" name="dtUltimaAsistencia" localVariable="parametro" localVariablePath="ultimaAsistencia" type="datepicker"></tns:field>
	          <tns:field label="estado" name="cboEstado" localVariable="parametro" localVariablePath="estado" type="enum-combo"></tns:field>
	          <tns:field label="nit" name="txtNit" localVariable="parametro" localVariablePath="nitDefault" type="text-field"></tns:field>
	          <tns:field label="nombre referente" name="txtNombreReferente" localVariable="parametro" localVariablePath="nombreReferente" type="text-field"></tns:field>
	          <tns:field label="ultimo servicio" name="dtFechaUltServicio" localVariable="parametro" localVariablePath="fechaUltServicio" type="datepicker"></tns:field>
		   </tns:fields>
		</tns:row>
		<tns:row>
		   <tns:fields>
	          <tns:field label="lugar ultimo servicio" name="txtLugarUltServicio" localVariable="parametro" localVariablePath="lugarUltServicio" type="text-field"></tns:field>
	          <tns:field label="servicio finalizado" name="chkServicioFinalizado" localVariable="parametro" localVariablePath="servicioFinalizado" type="check-field"></tns:field>	    	           
              <tns:field label="familiares con problemas" name="chkFamiliaresConProblemas" localVariable="parametro" localVariablePath="familiaresConProblemas" type="check-field"></tns:field>
	          <tns:field label="dentista" name="txtDentistaPersonal" localVariable="parametro" localVariablePath="dentistaPersonal" type="text-field"></tns:field>
		   </tns:fields>
		</tns:row>   
    </tns:form>
    
</tns:view>    

 </tns:views>